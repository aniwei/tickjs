$gwx_XC_92=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_92 || [];
function gz$gwx_XC_92_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_92_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_92_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_92_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([[7],[3,'$taroCompReady']])
Z([[2,'&&'],[[6],[[7],[3,'ShoppingBag']],[3,'shop']],[[2,'!=='],[[6],[[6],[[7],[3,'ShoppingBag']],[3,'shop']],[3,'region_code']],[1,'CN']]])
Z([3,'product-evaluation'])
Z([[7],[3,'loading']])
Z([[7],[3,'$compid__1627']])
Z([[7],[3,'anonymousState__temp32']])
Z([[7],[3,'anonymousState__temp35']])
Z([3,'index'])
Z([3,'item'])
Z([[7],[3,'loopArray595']])
Z([3,'$loopState__temp7'])
Z([3,'product-evaluation-item'])
Z([[6],[[7],[3,'item']],[3,'$compid__1626']])
Z([[6],[[7],[3,'item']],[3,'$loopState__temp34']])
Z([[2,'&&'],[[6],[[6],[[7],[3,'item']],[3,'$original']],[3,'images']],[[2,'>'],[[6],[[6],[[6],[[7],[3,'item']],[3,'$original']],[3,'images']],[3,'length']],[1,0]]])
Z([3,'childIndex'])
Z([3,'childItem'])
Z([[6],[[7],[3,'item']],[3,'$anonymousCallee__82']])
Z([3,'$loopState__temp25'])
Z(z[0])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_92_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_92_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_92=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_92=true;
var x=['./pages/index/_index/product_detail/product_comment.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_92_1()
var e6R=_v()
_(r,e6R)
if(_oz(z,0,e,s,gg)){e6R.wxVkey=1
var b7R=_v()
_(e6R,b7R)
if(_oz(z,1,e,s,gg)){b7R.wxVkey=1
}
else{b7R.wxVkey=2
var o8R=_n('view')
_rz(z,o8R,'class',2,e,s,gg)
var fAS=_v()
_(o8R,fAS)
if(_oz(z,3,e,s,gg)){fAS.wxVkey=1
var cBS=_n('rotate-view')
_rz(z,cBS,'compid',4,e,s,gg)
_(fAS,cBS)
}
else{fAS.wxVkey=2
}
fAS.wxXCkey=1
fAS.wxXCkey=3
var x9R=_v()
_(o8R,x9R)
if(_oz(z,5,e,s,gg)){x9R.wxVkey=1
}
var o0R=_v()
_(o8R,o0R)
if(_oz(z,6,e,s,gg)){o0R.wxVkey=1
var hCS=_v()
_(o0R,hCS)
var oDS=function(oFS,cES,lGS,gg){
var tIS=_n('view')
_rz(z,tIS,'class',11,oFS,cES,gg)
var oLS=_n('comment-score')
_rz(z,oLS,'compid',12,oFS,cES,gg)
_(tIS,oLS)
var eJS=_v()
_(tIS,eJS)
if(_oz(z,13,oFS,cES,gg)){eJS.wxVkey=1
}
var bKS=_v()
_(tIS,bKS)
if(_oz(z,14,oFS,cES,gg)){bKS.wxVkey=1
var xMS=_v()
_(bKS,xMS)
var oNS=function(cPS,fOS,hQS,gg){
var cSS=_v()
_(hQS,cSS)
if(_oz(z,19,cPS,fOS,gg)){cSS.wxVkey=1
}
cSS.wxXCkey=1
return hQS
}
xMS.wxXCkey=2
_2z(z,17,oNS,oFS,cES,gg,xMS,'childItem','childIndex','$loopState__temp25')
}
eJS.wxXCkey=1
bKS.wxXCkey=1
_(lGS,tIS)
return lGS
}
hCS.wxXCkey=4
_2z(z,9,oDS,e,s,gg,hCS,'item','index','$loopState__temp7')
}
x9R.wxXCkey=1
o0R.wxXCkey=1
o0R.wxXCkey=3
_(b7R,o8R)
}
b7R.wxXCkey=1
b7R.wxXCkey=3
}
e6R.wxXCkey=1
e6R.wxXCkey=3
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_92";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_92();	if (__vd_version_info__.delayedGwx) __wxAppCode__['pages/index/_index/product_detail/product_comment.wxml'] = [$gwx_XC_92, './pages/index/_index/product_detail/product_comment.wxml'];else __wxAppCode__['pages/index/_index/product_detail/product_comment.wxml'] = $gwx_XC_92( './pages/index/_index/product_detail/product_comment.wxml' );
	;__wxRoute = "pages/index/_index/product_detail/product_comment";__wxRouteBegin = true;__wxAppCurrentFile__="pages/index/_index/product_detail/product_comment.js";define("pages/index/_index/product_detail/product_comment.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
(wx.webpackJsonp=wx.webpackJsonp||[]).push([[333],{1012:function(t,e,n){"use strict";n.r(e);var o,a=n(342),r=n.n(a);for(o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e.default=r.a},1684:function(t,e,n){t.exports=n.p+"pages/index/_index/product_detail/product_comment.wxml"},2881:function(t,e,n){"use strict";n.r(e),n(2882);var o,a=n(1012);for(o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o)},2882:function(t,e,n){"use strict";n(1684)},2883:function(t,e,n){},342:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=S(n(3)),a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],o=!0,a=!1,r=void 0;try{for(var i,u=t[Symbol.iterator]();!(o=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var u,s=n(0),l=S(s),c=n(20),m=n(8),p=S(n(31)),d=S(n(7)),_=S(n(2)),f=S(n(9)),g=n(10),y=S(n(21)),h=n(15);function S(t){return t&&t.__esModule?t:{default:t}}function v(t){return function(){var e=t.apply(this,arguments);return new Promise((function(t,n){return function o(a,r){try{var i=e[a](r),u=i.value}catch(a){return void n(a)}if(!i.done)return Promise.resolve(u).then((function(t){o("next",t)}),(function(t){o("throw",t)}));t(u)}("next")}))}}function $(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function A(){var t,e,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,A);for(var a,r=arguments.length,i=Array(r),u=0;u<r;u++)i[u]=arguments[u];return(t=e=$(this,(t=A.__proto__||Object.getPrototypeOf(A)).call.apply(t,[this].concat(i)))).$usedState=["anonymousState__temp","anonymousState__temp2","anonymousState__temp3","anonymousState__temp4","anonymousState__temp5","anonymousState__temp32","loopArray595","$compid__1627","ShoppingBag","anonymousState__temp35","comments","forceUpdate","loading","productDetail"],e.getLang=function(){return _.default.getLang(d.default.lang,"index")},e.getComments=(a=v(o.default.mark((function t(e,a){var r;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,c.getProductComments)(e,a);case 3:if(0===(r=t.sent).code&&r.data)return t.abrupt("return",r.data);t.next=6;break;case 6:return t.abrupt("return",void 0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",void 0);case 12:case"end":return t.stop()}}),t,n,[[0,9]])}))),function(t,e){return a.apply(this,arguments)}),e.starOneComment=function(t){d.default.checkLoginPipeline({triggerPath:y.default.index,loginCallBack:function(){e.tmpAnimateSet.add(t),e.setState({forceUpdate:e.state.forceUpdate+1}),setTimeout((function(){e.tmpAnimateSet.delete(t),e.tmpStarSet.add(t),e.setState({forceUpdate:e.state.forceUpdate+1})}),400),(0,c.postStarComment)(t).then((function(n){0===n.code&&(n={},e.props.productDetail&&(n.productId=e.props.productDetail.productId),p.default.shop&&(n.shopId=p.default.shop.id),n.commentId=t,f.default.event(g.IEventName.GOODS_COMMENT_STAR,"商品评论点赞",{type:g.IEventType.TRACK,data:n}))}))},isForce:!0})},e.calculateTextHeight=function(){var t=void 0;t=l.default.createSelectorQuery().in(e.$scope),e.commentComponentIds.forEach((function(n){t.select("#product-evaluation-item-content-text-"+n).boundingClientRect((function(t){t&&69<t.height&&e.tmpShouldUnfoldSet.add(n)})).exec((function(t){e.setState({forceUpdate:e.state.forceUpdate+1})}))}))},e.initialize=v(o.default.mark((function t(){var a;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.props.productDetail&&0!==e.props.productDetail.productId&&p.default.shop)return e.setState({loading:!0}),t.next=4,e.getComments(e.props.productDetail.productId,p.default.shop.id);t.next=7;break;case 4:(a=t.sent)&&Array.isArray(a.records)&&0<a.records.length?e.setState({comments:a.records,loading:!1}):e.setState({loading:!1}),setTimeout((function(){e.calculateTextHeight()}),500);case 7:case"end":return t.stop()}}),t,n)}))),e.anonymousFunc0Map={},e.anonymousFunc1Map={},e.anonymousFunc2Map={},e.anonymousFunc3Map={},e.customComponents=["RotateView","CommentScore"],$(e,t)}n(2883),function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(A,l.default.PureComponent),r(A,[{key:"_constructor",value:function(t){(function t(e,n,o){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);return void 0!==a?"value"in a?a.value:void 0!==(a=a.get)?a.call(o):void 0:null!==(e=Object.getPrototypeOf(e))?t(e,n,o):void 0})(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"_constructor",this).call(this,t),this.tmpStarSet=new Set,this.tmpAnimateSet=new Set,this.tmpUnfoldSet=new Set,this.tmpShouldUnfoldSet=new Set,this.commentComponentIds=new Set,this.viewStartTime=0,this.state={comments:[],forceUpdate:0,loading:!1},this.$$refs=new l.default.RefsArray}},{key:"componentDidMount",value:function(){var t=this;this.viewStartTime=(new Date).getTime(),setTimeout((function(){t.initialize()}),1e3)}},{key:"componentWillUnmount",value:function(){f.default.event(g.IEventName.GOODS_DETAIL_STAY_TIME,"商品选购弹窗停留时长",{type:g.IEventType.TRACK,data:{startTime:this.viewStartTime,endTime:(new Date).getTime()}})}},{key:"_createData",value:function(){var t=this;this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var e=this.$prefix,n=(0,s.genCompid)(e+"$compid__1627"),o=(f=a(n,2))[0],r=f[1];if(p.default.shop&&"CN"!==p.default.shop.region_code)return null;var i=this.__state.loading?(0,h.scalePx2dp)(32):null,u=this.__state.loading?(0,h.scalePx2dp)(32):null,l=this.__state.loading?(0,m.getSrc)("/img/common/ic_sunflower_loading.png",-1):null,c=this.__state.loading?this.getLang().common_loading:null,d=(0,m.getSrc)("/img/index/ic_comment_star_g.gif",-1),_=Array.isArray(this.__state.comments)&&0<this.__state.comments.length,f=(n=Array.isArray(this.__state.comments),Array.isArray(this.__state.comments)?this.__state.comments.map((function(n,o){n={$original:(0,s.internal_get_original)(n)},t.commentComponentIds.add(n.$original.commentId);var r=Array.isArray(t.__state.comments)?"product-evaluation-item-"+o:null,i=Array.isArray(t.__state.comments)?n.$original.headUrl||(0,m.getSrc)("/img/index/ic_comment_default_avatar.png",-1):null,u=Array.isArray(t.__state.comments)?n.$original.nickname||t.getLang().common_default_nickname:null,l=Array.isArray(t.__state.comments)?(0,s.internal_inline_style)(n.$original.likeStatus||t.tmpStarSet.has(n.$original.commentId)?{color:"#e25e5c"}:{}):null,c=Array.isArray(t.__state.comments)?t.tmpStarSet.has(n.$original.commentId)?n.$original.likeCount+1:n.$original.likeCount:null,p="jejzz"+o;t.anonymousFunc0Map[p]=function(){n.$original.likeStatus||t.tmpStarSet.has(n.$original.commentId)||t.starOneComment(n.$original.commentId)};var d=Array.isArray(t.__state.comments)?t.tmpAnimateSet.has(n.$original.commentId)?(0,m.getSrc)("/img/index/ic_comment_star_g.gif",-1):n.$original.likeStatus||t.tmpStarSet.has(n.$original.commentId)?(0,m.getSrc)("/img/index/ic_comment_star_p.png",-1):(0,m.getSrc)("/img/index/ic_comment_star_n.png",-1):null,_=Array.isArray(t.__state.comments)?!t.tmpUnfoldSet.has(n.$original.commentId)&&t.tmpShouldUnfoldSet.has(n.$original.commentId)?"product-evaluation-item-content-fold":"product-evaluation-item-content":null,f=Array.isArray(t.__state.comments)?(0,s.internal_inline_style)(!t.tmpUnfoldSet.has(n.$original.commentId)&&t.tmpShouldUnfoldSet.has(n.$original.commentId)?{WebkitBoxOrient:"vertical"}:{}):null,g=Array.isArray(t.__state.comments)?!t.tmpUnfoldSet.has(n.$original.commentId)&&t.tmpShouldUnfoldSet.has(n.$original.commentId)?3:void 0:null,y="jfazz"+o;t.anonymousFunc1Map[y]=function(e){55<e.nativeEvent.layout.height&&(t.tmpShouldUnfoldSet.add(n.$original.commentId),t.setState({forceUpdate:t.__state.forceUpdate+1}))};var S="jfbzz"+o;t.anonymousFunc2Map[S]=function(){t.tmpUnfoldSet.add(n.$original.commentId),t.setState({forceUpdate:t.__state.forceUpdate+1})};var v=Array.isArray(t.__state.comments)?(0,s.internal_inline_style)({height:(0,h.scalePx2dp)(16)}):null,$=Array.isArray(t.__state.comments)?(0,s.internal_inline_style)(t.__state.comments.length!==o+1?{}:{backgroundColor:"#00000000"}):null,A=!t.tmpUnfoldSet.has(n.$original.commentId)&&t.tmpShouldUnfoldSet.has(n.$original.commentId),w=n.$original.images&&0<n.$original.images.length?n.$original.images.map((function(e,a){e={$original:(0,s.internal_get_original)(e)};var r=null;a<3&&(r=n.$original.images&&0<n.$original.images.length?"product-evaluation-item-pic-"+a:null);var i="jfczz"+o+"-"+a;return t.anonymousFunc3Map[i]=function(){(0,m.previewImage)({urls:n.$original.images.map((function(t){return t.path})),currentUrl:e.$original.path})},{$loopState__temp25:r,_$indexKey4:i,$loopState__temp27:n.$original.images&&0<n.$original.images.length?"product-evaluation-item-pic-"+a:null,$original:e.$original}})):[],x=(0,s.genCompid)(e+"jfdzzzzzzz"+o,!0),b=(x=(b=a(x,2))[0],b[1]);return s.propsManager.set({score:n.$original.score},b,x),{$loopState__temp7:r,$loopState__temp9:i,$loopState__temp11:u,$loopState__temp13:l,$loopState__temp15:c,_$indexKey:p,$loopState__temp17:d,$loopState__temp19:_,$loopState__temp21:f,$loopState__temp23:g,_$indexKey2:y,_$indexKey3:S,$loopState__temp29:v,$loopState__temp31:$,$loopState__temp34:A,$anonymousCallee__82:w,$compid__1626:b,$original:n.$original}})):[]);return this.__state.loading&&s.propsManager.set({enable:!0,duration:2,iterationCount:"infinite",width:i,height:u},r,o),Object.assign(this.__state,{anonymousState__temp:i,anonymousState__temp2:u,anonymousState__temp3:l,anonymousState__temp4:c,anonymousState__temp5:d,anonymousState__temp32:_,loopArray595:f,$compid__1627:r,ShoppingBag:p.default,anonymousState__temp35:n}),this.__state}},{key:"anonymousFunc0",value:function(t){for(var e,n=arguments.length,o=Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return this.anonymousFunc0Map[t]&&(e=this.anonymousFunc0Map)[t].apply(e,o)}},{key:"anonymousFunc1",value:function(t){for(var e,n=arguments.length,o=Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return this.anonymousFunc1Map[t]&&(e=this.anonymousFunc1Map)[t].apply(e,o)}},{key:"anonymousFunc2",value:function(t){for(var e,n=arguments.length,o=Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return this.anonymousFunc2Map[t]&&(e=this.anonymousFunc2Map)[t].apply(e,o)}},{key:"anonymousFunc3",value:function(t){for(var e,n=arguments.length,o=Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return this.anonymousFunc3Map[t]&&(e=this.anonymousFunc3Map)[t].apply(e,o)}}]),r=u=A,u.$$events=["anonymousFunc0","anonymousFunc1","anonymousFunc2","anonymousFunc3"],u.$$componentPath="pages/index/_index/product_detail/product_comment",e.default=r,Component(n(0).default.createComponent(r))}},[[2881,0,1,2,3]]]);
},{isPage:false,isComponent:true,currentFile:'pages/index/_index/product_detail/product_comment.js'});require("pages/index/_index/product_detail/product_comment.js");