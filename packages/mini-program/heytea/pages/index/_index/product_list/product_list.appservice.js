$gwx_XC_101=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_101 || [];
function gz$gwx_XC_101_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_101_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_101_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_101_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([[7],[3,'$taroCompReady']])
Z([3,'p-index-list-wp'])
Z([[7],[3,'$compid__1445']])
Z([3,'scrollProduct'])
Z([3,'p-index-product-list'])
Z([3,'ibezz'])
Z([1,300])
Z([[7],[3,'scrollIntoView']])
Z([1,true])
Z(z[8])
Z([[7],[3,'anonymousState__temp']])
Z([[7],[3,'$compid__1446']])
Z([3,'p-index-list-c-ads'])
Z([3,'idx'])
Z([3,'category'])
Z([[7],[3,'loopArray498']])
Z([3,'$loopState__temp5'])
Z([[6],[[7],[3,'category']],[3,'$compid__1444']])
Z([[6],[[7],[3,'category']],[3,'$loopState__temp3']])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_101_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_101_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_101=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_101=true;
var x=['./pages/index/_index/product_list/product_list.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_101_1()
var oNW=_v()
_(r,oNW)
if(_oz(z,0,e,s,gg)){oNW.wxVkey=1
var cOW=_n('view')
_rz(z,cOW,'class',1,e,s,gg)
var oPW=_n('menu')
_rz(z,oPW,'compid',2,e,s,gg)
_(cOW,oPW)
var lQW=_mz(z,'scroll-view',['bindscroll',3,'class',1,'id',2,'scrollAnimationDuration',3,'scrollIntoView',4,'scrollWithAnimation',5,'scrollY',6,'style',7],[],e,s,gg)
var aRW=_mz(z,'ads',['compid',11,'id',1],[],e,s,gg)
_(lQW,aRW)
var tSW=_v()
_(lQW,tSW)
var eTW=function(oVW,bUW,xWW,gg){
var fYW=_mz(z,'product-item-wrapper',['compid',17,'id',1],[],oVW,bUW,gg)
_(xWW,fYW)
return xWW
}
tSW.wxXCkey=4
_2z(z,15,eTW,e,s,gg,tSW,'category','idx','$loopState__temp5')
_(cOW,lQW)
_(oNW,cOW)
}
oNW.wxXCkey=1
oNW.wxXCkey=3
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_101";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_101();	if (__vd_version_info__.delayedGwx) __wxAppCode__['pages/index/_index/product_list/product_list.wxml'] = [$gwx_XC_101, './pages/index/_index/product_list/product_list.wxml'];else __wxAppCode__['pages/index/_index/product_list/product_list.wxml'] = $gwx_XC_101( './pages/index/_index/product_list/product_list.wxml' );
	;__wxRoute = "pages/index/_index/product_list/product_list";__wxRouteBegin = true;__wxAppCurrentFile__="pages/index/_index/product_list/product_list.js";define("pages/index/_index/product_list/product_list.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
(wx.webpackJsonp=wx.webpackJsonp||[]).push([[342],{1226:function(t,e,o){"use strict";o.r(e);var n,i=o(555),r=o.n(i);for(n in i)"default"!==n&&function(t){o.d(e,t,(function(){return i[t]}))}(n);e.default=r.a},1902:function(t,e,o){t.exports=o.p+"pages/index/_index/product_list/product_list.wxml"},3513:function(t,e,o){"use strict";o.r(e),o(3514);var n,i=o(1226);for(n in i)"default"!==n&&function(t){o.d(e,t,(function(){return i[t]}))}(n)},3514:function(t,e,o){"use strict";o(1902)},3515:function(t,e,o){},555:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=I(o(3)),i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var o=[],n=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(o.push(a.value),!e||o.length!==e);n=!0);}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return o}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o,n=arguments[e];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},a=function(t,e,o){return e&&s(t.prototype,e),o&&s(t,o),t};function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c,u=o(6),l=o(0),d=I(l),p=o(4),f=o(28),h=I(o(14)),g=I(o(56)),v=I(o(11));o(3515);var y=I(o(9)),m=o(10),P=I(o(13)),_=I(o(2)),w=I(o(1)),S=o(48),b=o(71);function I(t){return t&&t.__esModule?t:{default:t}}function O(t){return function(){var e=t.apply(this,arguments);return new Promise((function(t,o){return function n(i,r){try{var a=e[i](r),s=a.value}catch(i){return void o(i)}if(!a.done)return Promise.resolve(s).then((function(t){n("next",t)}),(function(t){n("throw",t)}));t(s)}("next")}))}}function A(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function L(){var t,e,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,L);for(var i,a,s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return(t=e=A(this,(t=L.__proto__||Object.getPrototypeOf(L)).call.apply(t,[this].concat(c)))).$usedState=["anonymousState__temp","loopArray498","$compid__1445","$compid__1446","scrollIntoView","products","isShowProductDetail","categoryListConfig","__fn_on","isParty","menu","viewProductsAds","activityStore","shoppingBagStore","notices","user","adsTotalHeight","adsIsInit","soldOutList","shareProductId","banners"],e.showShareProductDetail=function(){var t=e.props.shareProductId;t&&setTimeout((function(){e.changeProductPositioning(t,!0)}),1200)},e.showSelectSpecificationEvent=function(){P.default.getInstance().events.on(w.default.eventNames.showSelectSpecEvent,(function(t,o,n,i){var r,a=e.props.products,s=[];a.forEach((function(t){t=void 0===(t=t.data)?[]:t,s.push.apply(s,function(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return Array.from(t)}(t))})),0<s.length&&(r=s.find((function(e){return e=void 0===(e=e.id)?0:e,Number(t)===e})))?(e.selectSpecification(r,r.category_name,i),o&&o()):n&&n()}))},e.checkLonganSupportTakeAway=function(t,e){return e=e.find((function(t){return 12===t.id})).data.find((function(e){return e.id===t})),Boolean(e.support_takeaway)},e.changeProductPositioning=function(t){var o=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=((i=e.props).onProductPositioning,i.products),i=(r=i.shoppingBagStore||{}).takeoutAddress,r=r.showIndexToast;1518!==t||!i||e.checkLonganSupportTakeAway(t,n)?o?((0,S.showSelectSpecificationView)({productId:t}),e.props.onProductPositioning(t)):e.props.onProductPositioning(0,"p-index-list-c-"+t):r("颗颗手剥，新鲜制作，暂不支持外送。\n欢迎您来门店自取，敬请谅解",2e3)},e._scrollProduct=function(t){var o,n=t.detail.scrollTop,i=(o=e.props).menu,r=o.adsTotalHeight,a=o.banners,s=(o.onProductPositioning,t=o.products,o.soldOutList),c=void 0===(o=e.state.categoryListConfig)?{}:o;if(0<a.length&&(n<=0?P.default.getInstance().events.trigger(w.default.eventNames.bannerAnimation,!0):40<n&&P.default.getInstance().events.trigger(w.default.eventNames.bannerAnimation,!1)),!1===e.scrollMutualFlag){for(var u=0,l=0,d=0;d<i.length;d+=1){var p=(g=i[d]||{}).height,f=g.narrowHeight,h=g.id,g=s&&s[h]||[];if(h=(c[h]||{}).soldOutSwitch,!(Math.ceil(n)-r>=Math.ceil(l*v.default.getLayoutRatio())-30*v.default.getLayoutRatio()))break;l+=g&&1<g.length&&!h?f:p,u=d}u<=i.length-1&&e.menuActiveCategoryId!==i[u].id&&(e.menuActiveCategoryId=i[u].id,e.setMenuActiveCategoryId(i[u].id),e.props.onProductPositioning(0))}},e.switchMenu=function(t){e.props.onProductPositioning,!1===e.scrollMutualFlag&&(e.scrollMutualFlag=!0,setTimeout((function(){e.scrollMutualFlag=!1}),1500)),e.props.onProductPositioning(0,"p-index-list-c-"+t.id)},e.setMenuActiveCategoryId=function(t){P.default.getInstance().events.trigger(w.default.eventNames.categoryLinkageId,t)},e.selectSpecification=(a=O(n.default.mark((function t(i,a,s){var c,u,l;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=e.props,u=l.shoppingBagStore,l=l.isParty,c=void 0!==l&&l,u=(l=u||{}).takeoutAddress,void 0!==(l=l.openDefaultShop)&&l)return t.next=5,(0,b.getUserLocationAuthority)();t.next=8;break;case 5:return t.sent?(0,b.showSystemLocationAuthority)({modal_parameter:{content:"hey，您可能未开启微信定位，请进入系统【设置】>>【隐私】>>【定位服务】中打开开关获取就近门店菜单或手动选择门店，即可享受下单服务",cancelText:"选择门店",confirmText:"授权定位",showCancel:!0,onCancelPress:function(){h.default.to(w.default.routes.chooseShop)}},callback:function(){e.setUserLocationAuthority(!0,6)}}):(0,b.showMiniLocationAuthority)(e.setUserLocationAuthority,{content:"开启喜茶GO定位授权获取就近门店菜单，或手动选择门店，即可享受下单服务",cancelText:"选择门店",onCancelPress:function(){h.default.to(w.default.routes.chooseShop)}}),t.abrupt("return");case 8:e.setState({isShowProductDetail:!0},(function(){"ios"!==v.default.getSysInfo().platform.toLocaleLowerCase()&&"devtools"!==v.default.getSysInfo().platform.toLocaleLowerCase()||!d.default.canIUse("hideTabBar")||c||d.default.hideTabBar({animation:!0})})),l=c?w.default.eventNames.partyProductDetail:w.default.eventNames.productDetail,P.default.getInstance().events.trigger(l,r({},i,{category_name:a}),s),y.default.event(m.IEventName.GOODS_CLICK,"点击商品",{type:m.IEventType.TRACK,data:{goodsId_var:""+i.id,goodsName_var:i.name,fstCat_var:a,buyWay_var:u?"外卖":"自取"}});case 12:case"end":return t.stop()}}),t,o)}))),function(t,e,o){return a.apply(this,arguments)}),e.setUserLocationAuthority=(i=O(n.default.mark((function t(i,r){var a;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=r||0,e.props.shoppingBagStore,i)return t.next=5,(0,f.getLocation)();t.next=7;break;case 5:(a=t.sent)&&a.latitude?P.default.getInstance().events.trigger(w.default.eventNames.refreshMenu,{clearShop:!0}):0<r&&setTimeout((function(){e.setUserLocationAuthority(i,(r||0)-1)}),1e3);case 7:case"end":return t.stop()}}),t,o)}))),function(t,e){return i.apply(this,arguments)}),e.refScrollView=function(t){return e.scrollView=t},e.switchMenuSoldOut=function(t){var o,n=void 0===((s=e.props).onProductPositioning,i=s.soldOutList)?{}:i,i=void 0===(s=(o=t||{}).category_id)?0:s,a=void 0===(t=o.product_id)?0:t,s=(t=(o=void 0===(s=e.state.categoryListConfig)?{}:s)[i]||{},!!a||!t.soldOutSwitch);n=((n=n&&n[i||0]||[])&&n[0]||{}).id,t=r({},t,{soldOutSwitch:s}),s||(e.props.onProductPositioning(n||0),setTimeout((function(){e.props.onProductPositioning(0)}),100)),e.setState({categoryListConfig:r({},o,function(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}({},i,t))},(function(){a&&e.props.onProductPositioning(0,"p-index-list-pro-"+a)}))},e.customComponents=["Menu","Ads","ProductItemWrapper"],A(e,t)}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)})(L,l.Component),a(L,[{key:"_constructor",value:function(t){(function t(e,o,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,o);return void 0!==i?"value"in i?i.value:void 0!==(i=i.get)?i.call(n):void 0:null!==(e=Object.getPrototypeOf(e))?t(e,o,n):void 0})(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"_constructor",this).call(this,t),this.state={isShowProductDetail:!1,categoryListConfig:{}},this.scrollMutualFlag=!1,this.scrollProduct=(0,g.default)(this._scrollProduct,100),this.menuActiveCategoryId=0,this.scrollView=null,this.isAlreadyShowProductDetail=!1,this.$$refs=new d.default.RefsArray}},{key:"componentDidMount",value:function(){var t=this;this.props.onProductPositioning,P.default.getInstance().events.on(w.default.eventNames.resetMenuList,(function(){t.props.onProductPositioning(0,"p-index-list-c-ads")})),P.default.getInstance().events.on(w.default.eventNames.closeSelectSpecification,(function(){t.setState({isShowProductDetail:!1})})),P.default.getInstance().events.on(w.default.eventNames.openCategorySoldOutMore,this.switchMenuSoldOut),this.showSelectSpecificationEvent()}},{key:"componentWillUnmount",value:function(){P.default.getInstance().events.off(w.default.eventNames.resetMenuList),P.default.getInstance().events.off(w.default.eventNames.closeSelectSpecification),this.props.isParty||P.default.getInstance().events.off(w.default.eventNames.showSelectSpecEvent),P.default.getInstance().events.off(w.default.eventNames.openCategorySoldOutMore)}},{key:"componentWillReceiveProps",value:function(t){var e,o=this;this.isAlreadyShowProductDetail||t.shareProductId&&t.products&&0<t.products.length&&(e=t.shareProductId,setTimeout((function(){o.changeProductPositioning(e,!0)}),1200),this.isAlreadyShowProductDetail=!0)}},{key:"_createData",value:function(){var t=this;this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var e=this.$prefix,o=(0,l.genCompid)(e+"$compid__1445"),n=(I=i(o,2))[0],r=I[1],a=(0,l.genCompid)(e+"$compid__1446"),s=(S=i(a,2))[0],c=S[1],u=(b=this.__props).menu,d=b.viewProductsAds,p=b.products,f=b.activityStore,h=b.shoppingBagStore,g=b.notices,y=b.user,m=b.adsTotalHeight,P=(o=b.adsIsInit,void 0!==(I=b.isParty)&&I),w=void 0===(a=b.soldOutList)?{}:a,S=h.scrollIntoView,b=void 0!==(I=h.openDefaultShop)&&I,I=(a=this.__state).isShowProductDetail,O=a.categoryListConfig,A=_.default.getLang("","index"),L=f.activeCupFreeActivity,x=(f=h.shoppingBagList,h=h.partyBagList,P?void 0===h?[]:h:f);return y=g.filter((function(t){return!t.activity_id})),h=[],L&&(h=g.filter((function(t){return t.activity_id===L.id}))),g=138,0<h.concat(y).length&&(g=178),g+=100,I&&(g-=160),f={height:v.default.setViewHeight(g,"rpx",!0)+"px"},I=(0,l.internal_inline_style)(f),g=p.map((function(o,n){var r=(v=(o={$original:(0,l.internal_get_original)(o)}).$original).name,a=v.id,s=void 0===(g=v.data)?[]:g,c=void 0===(y=v.categoryAds)?[]:y,u=w&&w[a],d=s?s.filter((function(t){return t.has_stock})):[],p=O&&O[a],f=(p||{}).soldOutSwitch,h=f?u||[]:u[0]?[u[0]]:[],g="p-index-list-c-"+a,v="p-index-list-c-"+n,y=(0,l.genCompid)(e+"ibfzzzzzzz"+n,!0);return y=(n=i(y,2))[0],n=n[1],l.propsManager.set({categoryId:a,name:r,categoryAds:c,commonList:d,bagList:x,isParty:P,showSoldOutItems:h,selectSpecification:t.selectSpecification,soldOutItems:u,switchMenuSoldOut:t.switchMenuSoldOut,soldOutSwitch:f,langObj:A},n,y),{name:r,id:a,data:s,categoryAds:c,soldOutItems:u,commonList:d,categoryConfig:p,soldOutSwitch:f,showSoldOutItems:h,$loopState__temp3:g,$loopState__temp5:v,$compid__1444:n,$original:o.$original}})),l.propsManager.set({menu:u,onSwitch:this.switchMenu,style:f},r,n),l.propsManager.set({adsTotalHeight:m,ads:d,adsIsInit:o,onProductPositioning:this.changeProductPositioning,openDefaultShop:b},c,s),this.$$refs.pushRefs([{type:"dom",id:"ibezz",refName:"",fn:this.refScrollView}]),Object.assign(this.__state,{anonymousState__temp:I,loopArray498:g,$compid__1445:r,$compid__1446:c,scrollIntoView:S,products:p}),this.__state}}]),a=c=L,c.$$events=["scrollProduct"],c.$$componentPath="pages/index/_index/product_list/product_list",a.defaultProps={menu:[],viewProductsAds:[],banners:[],products:[],notices:[],adsTotalHeight:0,scrollIntoView:"",onProductPositioning:function(){},shareProductId:null,adsIsInit:!1,isParty:!1},a=(0,u.__decorate)([(0,p.inject)("activityStore","shoppingBagStore","user"),p.observer],a),e.default=a,Component(o(0).default.createComponent(a))}},[[3513,0,1,2,3]]]);
},{isPage:false,isComponent:true,currentFile:'pages/index/_index/product_list/product_list.js'});require("pages/index/_index/product_list/product_list.js");